```markdown
```@meta
CurrentModule = PhyloPickMe
```

# PhyloPickMe.jl Documentation

**PhyloPickMe** is a Julia package for selecting samples for inclusion in a Species Tree Analysis.

## Context
Biologists have access to vast amounts of DNA sequence data. For a fixed collection of species, individual samples are often missing from the genetic data available. This raises the question: how can one determine when there is enough data to justify including a particular sample/species in an analysis? Traditionally, researchers have relied on ad hoc methodologies (e.g., requiring a sample to be present in 75% of all sequenced genes).

**PickMe** is a software tool that recommends which samples should be included in a full analysis based on Bayesian analysis, assessing whether the data can be described by a single species tree. Thus, PickMe can be a valuable component of the species tree analysis pipeline.

## Reference
For both the PhyloPickMe package and the underlying sample selection methodology, please cite:

> Joseph Rusinko, Yu Cai, Allison Doherty, Katherine Thompson, Julien Boutte, Mark Fishbein, and Shannon C. K. Straub (2024).  
> **PickMe: Sample Selection for Species Tree Reconstruction Using Coalescent Weighted Quartets**. Under review.

## Function Usage
```julia
PickMe(InputTreeFile::String, OutputFile::String)
```

## PickMe Tutorial for Julia Beginners

### Installation 

#### Install Julia
Use the Julia [official link](http://julialang.org) to install Julia on your machine of choice. PickMe is independent of your operating system.

#### Select a Code Editor
Choose and install one of the following code editors (similar to installing R-Studio for R users):

- **[Visual Studio Code](https://code.visualstudio.com)**: An editor and integrated development environment (IDE) for Julia.
- **[Juno](http://junolab.org)**: An IDE for Julia based on the [Atom](http://atom.io/) editor.
- **[Jupyter](http://jupyter.org)**: A notebook interface for Julia.

#### Open Julia in Your Editor of Choice
When working with Julia, you will encounter a command line that says:

```julia
julia>
```
This is the prompt you want for running specific Julia code.

Alternatively, you might see:

```julia
packageName>
```
This prompt indicates you are in package mode. You can toggle between modes using `]` to enter package mode and backspace to return to the Julia prompt.

#### Add the Julia Package
First, let Julia know you want to use its package functions by running:

```julia
julia> using Pkg
```

Then, shift into package mode by toggling with `]`. Add the PickMe package using:

```julia
pkg> add PhyloPickMe
```

You may need to press "y" to confirm the addition, and wait a couple of minutes while the program sets up.

Finally, toggle back to Julia mode by pressing backspace.

#### Confirm the Julia Package is Working
To precompile the Julia code and test that the program has been successfully installed, run the following code:

```julia
julia> PickMe("sampletrees.txt", "Mytestoutput.csv")
```

The output in `Mytestoutput.csv` should match the `testoutput.txt` file on GitHub.

## Running PickMe

### Estimate Initial Gene Trees Using All Available Data
Estimate gene trees for your sequence data using your method of choice (this does not require Julia).

### Input File Requirements
Trees should be collected into a single file, with one gene tree in Newick format per line, each ending with a semicolon (`;`).

**PickMe** requires a `.txt` file including all phylogenetic trees generated by phylogenomic tools (e.g., RAxML, IQ-TREE). All tree files must have the same sample names (e.g., Sample_Potato).

Some gene tree pipelines may include the gene identifier along with the sample in each of the individual gene trees. **PickMe** will assume that each identifier/sample combination is its own unique sample. If this is the case, the `.txt` file can be cleaned using [CTN.py](https://github.com/juboutte?tab=repositories).

### Run PickMe
Assuming your tree file is in the active folder and labeled `genetrees.txt`, run the command:

```julia
julia> PickMe("genetrees.txt", "PickMeOutputMyGeneTrees.csv")
```

### Begin Species Tree Analysis
We recommend beginning your species tree analysis with sequence alignment using only the samples identified by **PickMe** as "Good," "Very Good," or "Exceptional."

### Warnings
- **PickMe** only uses the topology of each input gene tree and safely ignores bootstrap values or branch lengths. However, we recommend not estimating these values in your pre-PickMe analysis to save time.
- **PickMe** assumes a single individual per species. While it will run with multiple samples per species, it will treat each individual as its own species, which is **not recommended**.
- **PickMe** should not be used as a test for hybridization, as hybrid samples may be recommended by **PickMe** (see the supplemental material of the article for specific details).

### Related Packages
The package [PhyloNetworks](https://juliaphylo.github.io/PhyloNetworks.jl/dev/) may be a useful tool for exploring non-tree-based artifacts of the set of gene trees, which **PickMe** is not designed to address.

> Claudia Solís-Lemus, Paul Bastide, and Cécile Ané (2017).  
> **PhyloNetworks: A Package for Phylogenetic Networks**.  
> *Molecular Biology and Evolution* 34(12): 3292–3298.  
> [doi:10.1093/molbev/msx235](https://doi.org/10.1093/molbev/msx235)
